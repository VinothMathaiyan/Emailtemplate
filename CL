import pandas as pd
import os
from datetime import datetime

# List of Excel files to combine
excel_files = ["file1.xlsx", "file2.xlsx", "file3.xlsx"]  # Update with your actual file names

# Output file name
output_file = "combined_file.xlsx"

# Read and combine all files
all_data = []

for file in excel_files:
    if os.path.exists(file):  # Check if the file exists
        df = pd.read_excel(file)
        df["File Name"] = file  # Add file name column
        df["Date Updated"] = datetime.now().strftime("%Y-%m-%d %H:%M:%S")  # Add timestamp
        all_data.append(df)

# Combine all DataFrames into one
final_df = pd.concat(all_data, ignore_index=True)

# Check if the output file already exists
if os.path.exists(output_file):
    existing_df = pd.read_excel(output_file)
    final_df = pd.concat([existing_df, final_df], ignore_index=True)  # Append new data

# Save the final combined file
final_df.to_excel(output_file, index=False)

print(f"Successfully combined {len(excel_files)} files into '{output_file}'.")
