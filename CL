# Function to compute sentiment
def get_sentiment(response):
    polarity = TextBlob(response).sentiment.polarity

    # Mapping sentiment score to labels
    if polarity <= -0.6:
        sentiment_label = "Very Negative"
        numeric_score = -2
    elif -0.6 < polarity <= -0.2:
        sentiment_label = "Negative"
        numeric_score = -1
    elif -0.2 < polarity <= 0.2:
        sentiment_label = "Neutral"
        numeric_score = 0
    elif 0.2 < polarity <= 0.6:
        sentiment_label = "Positive"
        numeric_score = 1
    else:
        sentiment_label = "Very Positive"
        numeric_score = 2

    return sentiment_label, numeric_score

# Apply sentiment analysis
df_1234[["Sentiment Label", "Sentiment Score"]] = df_1234["Response"].astype(str).apply(
    lambda x: pd.Series(get_sentiment(x))
)
df_5678[["Sentiment Label", "Sentiment Score"]] = df_5678["Response"].astype(str).apply(
    lambda x: pd.Series(get_sentiment(x))
)
