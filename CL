import json
import os

# Import the data
os.chdir(r'D:\Hackaton\EXCELtoQSF')

def format_qsf(input_file_path, output_file_path):
    try:
        # Read the content of the .qsf file
        with open(input_file_path, 'r') as file:
            content = file.read()
        
        # Parse and reformat the JSON content
        formatted_content = json.dumps(json.loads(content), indent=4)
        
        # Write the formatted JSON to a new file
        with open(output_file_path, 'w') as formatted_file:
            formatted_file.write(formatted_content)
        
        print(f"File formatted successfully! Formatted file saved at: {output_file_path}")
    
    except Exception as e:
        print(f"An error occurred: {e}")

# Input and output file paths
input_file = "Template_v1.qsf"  # Replace with the path to your .qsf file
output_file = "Template_v1_x.qsf"  # Replace with the desired output file path

# Format the .qsf file
format_qsf(input_file, output_file)
