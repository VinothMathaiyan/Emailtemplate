import json
import pandas as pd

# Replace 'yourfile.qsf' with your QSF file name
with open('yourfile.qsf', 'r', encoding='utf-8-sig') as file:
    data = json.load(file)

# Extract elements where "Element" is "BL"
bl_elements = [element for element in data['SurveyElements'] if element.get('Element') == 'BL']

# Extract headers and values
rows = []
for element in bl_elements:
    payload = element['Payload']
    headers = payload.keys()
    values = payload.values()
    rows.append(dict(zip(headers, values)))

# Convert to DataFrame and save to Excel
df = pd.DataFrame(rows)
df.to_excel('bl_elements.xlsx', index=False)

print("Data successfully extracted to 'bl_elements.xlsx'")
