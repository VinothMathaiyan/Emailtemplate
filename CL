import json
import pandas as pd

# Replace 'yourfile.qsf' with your QSF file name
with open('yourfile.qsf', 'r', encoding='utf-8-sig') as file:
    data = json.load(file)

# Extract elements where "Element" is "BL"
bl_elements = [element for element in data['SurveyElements'] if element.get('Element') == 'BL']

# Prepare data for the DataFrame
rows = []
for element in bl_elements:
    payload = element['Payload']
    row = {}
    for key, value in payload.items():
        if isinstance(value, dict):  # if value is another dictionary, flatten it
            for sub_key, sub_value in value.items():
                row[f"{key}_{sub_key}"] = sub_value
        else:
            row[key] = value
    rows.append(row)

# Convert to DataFrame
df = pd.DataFrame(rows)

# Transpose the DataFrame so each key becomes a column
df = df.melt(var_name='Header', value_name='Value')

# Save to Excel
df.to_excel('bl_elements_transposed.xlsx', index=False)

print("Data successfully extracted to 'bl_elements_transposed.xlsx'")
