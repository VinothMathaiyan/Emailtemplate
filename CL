import pandas as pd
import os

def combine_excel_files(file_list, output_file="Master.xlsx"):
  """
  Combines multiple Excel files into a single Master file.

  Args:
    file_list: A list of file names to be combined.
    output_file: The name of the output Excel file (default: "Master.xlsx").
  """

  df_master = pd.DataFrame()

  for file_name in file_list:
    try:
      df_temp = pd.read_excel(file_name)
      df_temp['Survey Name'] = file_name
      df_master = pd.concat([df_master, df_temp], ignore_index=True)
    except Exception as e:
      print(f"Error processing {file_name}: {e}")

  try:
    if os.path.exists(output_file):
      with pd.ExcelWriter(output_file, mode='a', engine='openpyxl', if_sheet_exists='replace') as writer:
        df_master.to_excel(writer, sheet_name='Sheet1', index=False)
    else:
      df_master.to_excel(output_file, index=False)
  except Exception as e:
    print(f"Error writing to {output_file}: {e}")

# Example usage:
file_list = ['file1.xlsx', 'file2.xlsx', 'file3.xlsx']  # Replace with your actual file names
combine_excel_files(file_list)
