import pandas as pd

# Read the input file
file_path = input("Enter the Excel file path: ")  # Allow user to input file name
df_keywords = pd.read_excel(file_path, sheet_name="Keyword_Dictionary")

# Convert to dictionary format { 'Keyword': ['Synonym1', 'Synonym2', ...] }
keyword_dict = df_keywords.set_index("Keyword")["Synonyms"].str.split(";").to_dict()

# Print to verify
print("Keyword Dictionary Loaded:", keyword_dict)


def expand_text(text, keyword_dict):
    for keyword, synonyms in keyword_dict.items():
        for synonym in synonyms:
            if synonym.lower() in text.lower():
                text += f" {keyword}"  # Append the main keyword
    return text

# Read the sheets where responses exist
df_1234 = pd.read_excel(file_path, sheet_name="1234")
df_5678 = pd.read_excel(file_path, sheet_name="5678")

# Apply keyword expansion to responses
df_1234["Response"] = df_1234["Response"].apply(lambda x: expand_text(str(x), keyword_dict))
df_5678["Response"] = df_5678["Response"].apply(lambda x: expand_text(str(x), keyword_dict))

# Print verification
print("Keyword expansion applied to responses!")
