!DOCTYPE html>
<html ng-app="previewDictator" dir="ltr">
<head>
  <meta charset="UTF-8">
  <title ng-non-bindable>Preview - Qualtrics Survey | Qualtrics Experience Management</title>

  <meta property="og:title" content="Preview - Qualtrics Survey | Qualtrics Experience Management" ng-non-bindable>
  <meta property="og:description" content="The most powerful, simple and trusted way to gather experience data. Start your journey to experience management and try a free account today." ng-non-bindable>
  
  <link type="image/x-icon" rel="icon" href="https://barclayssandboxex.qualtrics.com/brand-management/brand-assets/barclayssandboxex/favicon.ico">
  
  <meta name="description" content="The most powerful, simple and trusted way to gather experience data. Start your journey to experience management and try a free account today." ng-non-bindable>
  <meta name="robots" content="noindex">
  <meta id="meta-viewport" name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=2.5">
  <link rel="stylesheet" type="text/css" href="/jfe/static/dist/jfePreview.6030bb302dd8163b3500.min.css">
  <script>
    (function(w) {
  'use strict';
  if (w.history && w.history.replaceState) {
    var path = w.location.pathname;
    var jfePathRegex = /^\/jfe\d+\//;

    if (jfePathRegex.test(path)) {
      w.history.replaceState(null, null, w.location.href.replace(path, path.replace(jfePathRegex, '/jfe/')));
    }
  }
})(window);

  </script>

  <script type="text/javascript">
    var QPreviewSettings = {
      hasBookmark: false,
      bookmarksDisabled: false,
      expectedNumPages: 2,
      qrcode: 'https://barclayssandboxex.qualtrics.com/jfe9/preview/previewId/614935f4-3c37-44fe-a3e3-2cb20619d6de/SV_4UU1yQRnA8sE2Ts?Q_CHL=preview&amp;Q_SurveyVersionID=current',
      enableMobilePreview: true,
      messages: {"preview":"Preview","previewTitle":"Previewing Survey","closePreview":"Close Preview","restartPreview":"Restart Survey","ignoreValidation":"Ignore validation","showHiddenQuestions":"Show hidden questions","placeBookmark":"Place Bookmark","goToBookmark":"Go to Bookmark","clearBookmark":"Clear Bookmark","archivedVersion":"Archived version","publishedVersion":"Published","draftVersion":"Draft","viewPublishedVersion":"View published version","viewDraftVersion":"View draft","themeInProgress":"The latest changes to your theme are still being built and will be available momentarily.","bookmark":"Bookmark","clear":"Clear","mobileView":"Mobile view","mobileViewOn":"Mobile view on","mobileViewOff":"Mobile view off","scanQRCode":"Scan QR code","qrCode":"QR Code","qrCodeDescription":"Scan this QR Code to preview your survey on your own device.","close":"Close","tools":"Tools","brandOnly":"Brand internal only","brandOnlyHelperText":"Only users within your brand with the link can view the survey preview.","copyLink":"Copy Link","save":"Save","linkCopied":"Link copied","linkVisibilityPermissions":"Link visibility permissions","previewLink":"Preview link","public":"Public","publicHelperText":"Any users with the link can view the survey preview.","readOnly":"Read only","sharePreview":"Share Preview","sharingTimeout":"Your current session has timed out. <a href='{{link}}'>Please log in again</a> to manage this survey preview.","sharingNetworkError":"An unexpected network error occured. Please try again.","sharingNoPermission":"You do not have permission to manage this survey preview. <a href='{{link}}'>Please log in</a> to make further changes.","sharingNoPermissionLoggedIn":"You do not have permission to manage this survey preview. Please contact the survey owner to request changes.","sharePreviewExplanation":"Previews are useful for getting feedback from other people in your organization on the contents of your survey.","sharePreviewWarning":"This link should not be shared except for the purposes of testing. Use the Distributions tab to collect responses.","visibilityBrandOnly":"Visibility: Brand internal only","visibilityPublic":"Visibility: Public"},
      viewingDraftVersion: true,
      viewingPublishedVersion: false,
      viewingArchivedVersion: false,
      isPreviewLandingWithSharing: true,
      isBlockPreview: false,
      isQuestionPreview: false,
      contextLibraryId: ''
    };
  </script>
  <script>(()=>{"use strict";var r,e={},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,r=[],n.O=(e,t,o,i)=>{if(!t){var a=1/0;for(f=0;f<r.length;f++){for(var[t,o,i]=r[f],l=!0,s=0;s<t.length;s++)(!1&i||a>=i)&&Object.keys(n.O).every((r=>n.O[r](t[s])))?t.splice(s--,1):(l=!1,i<a&&(a=i));if(l){r.splice(f--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var f=r.length;f>0&&r[f-1][2]>i;f--)r[f]=r[f-1];r[f]=[t,o,i]},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(r){if("object"==typeof window)return window}}(),n.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),n.nmd=r=>(r.paths=[],r.children||(r.children=[]),r),(()=>{var r={338:0};n.O.j=e=>0===r[e];var e=(e,t)=>{var o,i,[a,l,s]=t,c=0;if(a.some((e=>0!==r[e]))){for(o in l)n.o(l,o)&&(n.m[o]=l[o]);if(s)var f=s(n)}for(e&&e(t);c<a.length;c++)i=a[c],n.o(r,i)&&r[i]&&r[i][0](),r[i]=0;return n.O(f)},t=self.webpackChunkjavascriptformengine=self.webpackChunkjavascriptformengine||[];t.forEach(e.bind(null,0)),t.push=e.bind(null,t.push.bind(t))})()})();</script>
  <script src="/jfe/static/dist/jfeLib.fa2484b7040929bdf0ac.min.js" crossorigin="anonymous"></script>
  <script src="/jfe/static/dist/jfePreview.d97a6349c0ae1a7129df.min.js"></script>
  <script>
    document.addEventListener('keydown', function(event) {
      if (event.keyCode == 13) {
        // Forward enter key to the preview's body so it can autoadvance if necessary
        window.frames['preview-view'].contentDocument.body.dispatchEvent(new Event('previewController-enter'));
      }
    });
  </script>
</head>
<body ng-controller="previewController" ng-class="{'mobile-inactive': !mobileActive}">
<div id="preview-banner" class="banner-with-sharing">
  <div id="preview-actions">
    <div class="btn button-primary" id="restart-survey-btn" ng-click="pageService.restartForm()" ng-hide="smallScreen || (pageService.isEndOfSurvey)">
      <span>{{dynamicMessages.restart}}</span>
    </div>

    
    <div id="bookmark-container" ng-hide="smallScreen || pageService.bookmarksDisabled">
      <div id="bookmark-options" class="btn" qstrap.select-menu ng-model="unusedModel" items="bookmarkOptions" ng-hide="!smallScreen">
        <span>Bookmark</span>
        <span class="icon icon-angle-down-sm"></span>
      </div>

      <div id="bookmark-actions" role="group" ng-hide="smallScreen">
        <div id="placeBookmark" class="btn button-secondary" ng-click="pageService.setBookmark()" ng-hide="pageService.hasBookmark || pageService.bannerDisabled">
          <span>{{dynamicMessages.placeBookmark}}</span>
        </div>

        <div class="btn button-secondary" ng-click="pageService.loadBookmark()" ng-hide="!pageService.hasBookmark || pageService.bannerDisabled">
          <span>Go to Bookmark</span>
        </div>

        <div class="btn button-tertiary" ng-click="pageService.removeBookmark()" ng-hide="!pageService.hasBookmark || pageService.bannerDisabled">
          <span>Clear</span>
        </div>
      </div>
    </div>
    

    <div class="banner-divider" ng-hide="smallScreen"></div>

    <div id="advanced-options" class="btn" qstrap.select-menu multi-select="1" ng-model="selectedOptions" items="advancedOptions" on-change="advancedOptionsChanged($value)">
      <span>Tools</span>
      <span class="icon icon-angle-down-sm"></span>
    </div>

    
    <div id="mobile-view-button-container" ng-hide="smallScreen || pageService.bannerDisabled">
        <input id="mobile-view-checkbox" type="checkbox" ng-model="mobileActive" ng-change="toggleMobile($value)">
        <label qstrap.tooltip position="bottom" content="{{dynamicMessages.mobileSwitchLabel}}" for="mobile-view-checkbox" ng-class="{'mobile-active': mobileActive}">
            <svg aria-hidden="true" data-icontype="MobilePortrait" height="1.5rem" viewBox="0 0 24 24" width="1.5rem" xmlns="http://www.w3.org/2000/svg"><path d="M12.0001 17.7065C11.4969 17.7065 11.0482 18.1078 11.0482 18.6522C11.0482 19.1966 11.4969 19.5978 12.0001 19.5978C12.5034 19.5978 12.9521 19.1966 12.9521 18.6522C12.9521 18.1078 12.5034 17.7065 12.0001 17.7065Z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M8.25 2.25C7.00736 2.25 6 3.25736 6 4.5V19.5C6 20.7426 7.00736 21.75 8.25 21.75H15.75C16.9926 21.75 18 20.7426 18 19.5V4.5C18 3.25736 16.9926 2.25 15.75 2.25H8.25ZM16.5 15.5543V4.5C16.5 4.08579 16.1642 3.75 15.75 3.75H8.25C7.83579 3.75 7.5 4.08579 7.5 4.5V15.5543H16.5ZM7.5 17.0543H16.5V19.5C16.5 19.9142 16.1642 20.25 15.75 20.25H8.25C7.83579 20.25 7.5 19.9142 7.5 19.5V17.0543Z"></path></svg>
        </label>
    </div>
    

    <button id="share-preview-btn" class="btn button-primary" aria-label="Share Preview" ng-click="showModal('sharePreview')" qstrap.tooltip position="bottom" content="{{dynamicMessages.sharingLabel}}" tooltip-disabled="!pageService.previewSharing.enabled || pageService.previewSharing.popover" ng-disabled="!pageService.previewSharing.enabled">
        <svg aria-hidden="true" data-icontype="Share" height="1.5rem" viewBox="0 0 24 24" width="1.5rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.25 7C13.25 4.92893 14.9289 3.25 17 3.25C19.0711 3.25 20.75 4.92893 20.75 7C20.75 9.07107 19.0711 10.75 17 10.75C15.6401 10.75 14.4492 10.0261 13.7918 8.94264L8.71442 11.4813C8.73788 11.6509 8.75 11.824 8.75 12C8.75 12.176 8.73788 12.3491 8.71442 12.5187L13.7918 15.0574C14.4492 13.9739 15.6401 13.25 17 13.25C19.0711 13.25 20.75 14.9289 20.75 17C20.75 19.0711 19.0711 20.75 17 20.75C14.9289 20.75 13.25 19.0711 13.25 17C13.25 16.824 13.2621 16.6509 13.2856 16.4813L8.20823 13.9426C7.55077 15.0261 6.35992 15.75 5 15.75C2.92893 15.75 1.25 14.0711 1.25 12C1.25 9.92893 2.92893 8.25 5 8.25C6.35992 8.25 7.55077 8.97389 8.20823 10.0574L13.2856 7.51868C13.2621 7.34915 13.25 7.17599 13.25 7ZM17 4.75C15.7574 4.75 14.75 5.75736 14.75 7C14.75 8.24264 15.7574 9.25 17 9.25C18.2426 9.25 19.25 8.24264 19.25 7C19.25 5.75736 18.2426 4.75 17 4.75ZM5 9.75C3.75736 9.75 2.75 10.7574 2.75 12C2.75 13.2426 3.75736 14.25 5 14.25C6.24264 14.25 7.25 13.2426 7.25 12C7.25 10.7574 6.24264 9.75 5 9.75ZM17 14.75C15.7574 14.75 14.75 15.7574 14.75 17C14.75 18.2426 15.7574 19.25 17 19.25C18.2426 19.25 19.25 18.2426 19.25 17C19.25 15.7574 18.2426 14.75 17 14.75Z"></path></svg>
        <span>Share Preview</span>
    </button>
  </div>
</div>



<div id="preview-container">
  <div id="desktop-container" ng-hide="smallScreen && mobileActive">
    <iframe id="preview-view" src="/jfe9/previewForm/previewId/614935f4-3c37-44fe-a3e3-2cb20619d6de/SV_4UU1yQRnA8sE2Ts?Q_CHL=preview&amp;Q_SurveyVersionID=current" scrolling="{{pageService.transitioning ? 'no' : 'auto'}}" ng-class="{'transition': pageService.transitioning}"></iframe>
  </div>
  
    <div dir="ltr" id="mobile-container" ng-hide="!mobileActive">
      <div id="phone-overlay"></div>
      <div id="phone">
        <div id="inner-phone">
          <iframe height="100%" frameborder="0" id="mobile-preview-view" src="/jfe9/previewForm/previewId/614935f4-3c37-44fe-a3e3-2cb20619d6de/SV_4UU1yQRnA8sE2Ts?Q_CHL=preview&amp;Q_SurveyVersionID=current&amp;Q_MobilePreview=1" mobile-frame></iframe>
        </div>
      </div>
    </div>
  
</div>

<!-- Steal popover styles, but don't use an actual popover element since they only show up on click events -->
<div id="preview-sharing-popover" class="popover ng-scope bottom" ng-class="{'no-permission': !pageService.previewSharing.canEdit}" style="top: 60px; max-height: none; min-width: 0px; min-height: 0px;" ng-hide="!pageService.previewSharing.enabled || !pageService.previewSharing.popover">
    <div class="arrow"></div>
    <div class="popover-content">
        <div>
            <div class="close-container">
              <button aria-label="Close" class="icon-button" type="button" ng-click="pageService.previewSharing.hidePopover()">
                <svg aria-hidden="true" data-icontype="Close" height="1.5rem" viewBox="0 0 24 24" width="1.5rem" xmlns="http://www.w3.org/2000/svg">
                  <path d="M17.781 7.27855C18.0735 6.986 18.0729 6.51224 17.7797 6.22037C17.4865 5.9285 17.0116 5.92906 16.7191 6.22161L12 10.9407L7.28095 6.22161C6.9884 5.92906 6.51353 5.9285 6.22029 6.22037C5.92705 6.51224 5.9265 6.986 6.21905 7.27855L10.9406 12.0001L6.21905 16.7216C5.9265 17.0142 5.92705 17.4879 6.22029 17.7798C6.51353 18.0717 6.9884 18.0711 7.28095 17.7785L12 13.0595L16.7191 17.7785C17.0116 18.0711 17.4865 18.0717 17.7797 17.7798C18.0729 17.4879 18.0735 17.0142 17.781 16.7216L13.0594 12.0001L17.781 7.27855Z"></path>
                </svg>
              </button>
            </div>
            <div ng-bind-html="pageService.previewSharing.popoverContent" />
        </div>
    </div>
</div>


<!--BEGIN QUALTRICS SITE INTERCEPT-->
<script type='text/javascript'>
(function(){var g=function(e,h,f,g){
this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g+ "&t=" + (new Date()).getTime();document.body&&document.body.appendChild(a)}};
this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
try{(new g(100,"r","QSI_S_SI_9n3AP6tTS4aOGKF","//zn5ydlsbwpgrsccsp-qps.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_SIID=SI_9n3AP6tTS4aOGKF&Q_LOC="+encodeURIComponent(window.location.href))).start()}catch(i){}})();
</script><div id='SI_9n3AP6tTS4aOGKF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
<!--END SITE INTERCEPT-->

</body>
</html>


Qualtrics.SurveyEngine.addOnload(function() {
  // Function to create date from inputs
  function createDateFromInputs(dayId, monthId, yearId) {
    const day = document.getElementById(dayId).value;
    const month = document.getElementById(monthId).value;
    const year = document.getElementById(yearId).value;
    if (day && month && year) {
      return new Date(`${year}-${month}-${day}`);
    }
    return null;
  }

  // Function to set date picker's value from inputs
  function setDatePickerFromInputs(dayId, monthId, yearId, datePicker) {
    const date = createDateFromInputs(dayId, monthId, yearId);
    if (date) {
      const isoDate = date.toISOString().split('T')[0];
      datePicker.setAttribute('value', isoDate);
    }
  }

  // Function to update inputs from date picker
  function updateInputsFromDatePicker(datePicker, dayId, monthId, yearId) {
    const date = new Date(datePicker.value);
    document.getElementById(dayId).value = String(date.getDate()).padStart(2, '0');
    document.getElementById(monthId).value = String(date.getMonth() + 1).padStart(2, '0');
    document.getElementById(yearId).value = date.getFullYear();
  }

  // Function to validate dates and control the Next button state
  function validateDates() {
    const startDate = createDateFromInputs('start-day', 'start-month', 'start-year');
    const endDate = createDateFromInputs('end-day', 'end-month', 'end-year');
    const today = new Date().toISOString().split('T')[0];

    const startDatePicker = document.querySelector('duet-date-picker[identifier="start-date"]');
    const endDatePicker = document.querySelector('duet-date-picker[identifier="end-date"]');

    setDatePickerFromInputs('start-day', 'start-month', 'start-year', startDatePicker);
    setDatePickerFromInputs('end-day', 'end-month', 'end-year', endDatePicker);

    const startISO = startDate ? startDate.toISOString().split('T')[0] : null;
    const endISO = endDate ? endDate.toISOString().split('T')[0] : null;
    const fourDaysLater = startDate ? new Date(startDate.getTime() + 14 * 24 * 60 * 60 * 1000).toISOString().split('T')[0] : null;

    let valid = true;
    let startError = '';
    let endError = '';

    if (!startISO || !endISO || new Date(startISO) < new Date(today) || new Date(endISO) < new Date(fourDaysLater)) {
      valid = false;
      if (!startISO || new Date(startISO) < new Date(today)) {
        startError = 'Please select a start date that is today or later.';
        document.getElementById('start-day').style.borderColor = 'red';
        document.getElementById('start-month').style.borderColor = 'red';
        document.getElementById('start-year').style.borderColor = 'red';
      } else {
        document.getElementById('start-day').style.borderColor = '';
        document.getElementById('start-month').style.borderColor = '';
        document.getElementById('start-year').style.borderColor = '';
      }
      if (!endISO || new Date(endISO) < new Date(fourDaysLater)) {
        endError = 'Please select an end date that is at least fourteen days after the start date.';
        document.getElementById('end-day').style.borderColor = 'red';
        document.getElementById('end-month').style.borderColor = 'red';
        document.getElementById('end-year').style.borderColor = 'red';
      } else {
        document.getElementById('end-day').style.borderColor = '';
        document.getElementById('end-month').style.borderColor = '';
        document.getElementById('end-year').style.borderColor = '';
      }
    }

    document.getElementById('start-date-error').textContent = startError;
    document.getElementById('end-date-error').textContent = endError;

    jQuery(".Skin #Buttons #NextButton").prop('disabled', !valid);

    if (valid) {
      // Update embedded data
      const reminderDate = new Date(startDate.getTime() + 3 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
      Qualtrics.SurveyEngine.setEmbeddedData('JS_Survey_Open_Date', startISO);
      Qualtrics.SurveyEngine.setEmbeddedData('JS_Survey_Close_Date', endISO);
      Qualtrics.SurveyEngine.setEmbeddedData('Survey_Reminder_Date', reminderDate);
    }
  }

  // Create and append date pickers
  function createDatePicker(containerId, identifier) {
    const datePicker = document.createElement('duet-date-picker');
    datePicker.setAttribute('first-day-of-week', '0');
    datePicker.setAttribute('identifier', identifier);
    datePicker.setAttribute('required', 'true');
    const container = document.getElementById(containerId);
    container.appendChild(datePicker);
    return datePicker;
  }

  const startDatePicker = createDatePicker('duet-date-picker-container-start', 'start-date');
  const endDatePicker = createDatePicker('duet-date-picker-container-end', 'end-date');

  // Event listeners for date inputs
  document.getElementById('start-day').addEventListener('input', validateDates);
  document.getElementById('start-month').addEventListener('input', validateDates);
  document.getElementById('start-year').addEventListener('input', validateDates);
  document.getElementById('end-day').addEventListener('input', validateDates);
  document.getElementById('end-month').addEventListener('input', validateDates);
  document.getElementById('end-year').addEventListener('input', validateDates);

  // Event listeners for calendar buttons
  document.getElementById('start-calendarButton').addEventListener('click', function() {
    const startContainer = document.getElementById('duet-date-picker-container-start');
    startContainer.style.display = 'block';
    startDatePicker.focus();
  });
  document.getElementById('end-calendarButton').addEventListener('click', function() {
    const endContainer = document.getElementById('duet-date-picker-container-end');
    endContainer.style.display = 'block';
    endDatePicker.focus();
  });

  // Event listeners for date pickers
  startDatePicker.addEventListener('duetChange', function(event) {
    updateInputsFromDatePicker(startDatePicker, 'start-day', 'start-month', 'start-year');
    validateDates();
  });

  endDatePicker.addEventListener('duetChange', function(event) {
    updateInputsFromDatePicker(endDatePicker, 'end-day', 'end-month', 'end-year');
    validateDates();
  });

  // Initial validation check
  validateDates();
});

Qualtrics.SurveyEngine.addOnReady(function() {
  // Ensure initial validation checks are applied to determine the state of the Next button
  jQuery(".Skin #Buttons #NextButton").show();
});
